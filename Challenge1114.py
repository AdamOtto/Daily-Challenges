'''
On election day, a voting machine writes data in
the form (voter_id, candidate_id) to a text file.

Write a program that reads this file as a stream and
returns the top 3 candidates at any given time.
If you find a voter voting more than once, report this as fraud.
'''

def Solution(ar):
    candidates = {}
    voters = set()
    l = len(ar)
    fraudsters = set()
    for i in range(0, l):
        if ar[i][1] not in candidates:
            candidates[ar[i][1]] = 1
        else:
            candidates[ar[i][1]] += 1
        if ar[i][0] not in voters:
            voters.add(ar[i][0])
        else:
            fraudsters.add("Voter " + str(ar[i][0]) + " is committing fraud")
    
    if len(fraudsters) > 0:
        for f in fraudsters:
            print(f)
    
    top3 = []
    for key, val in candidates.items():
        top3.append( (key,val) )
    top3 = sorted(top3, key = lambda x:x[1], reverse=True)
    print(top3)
    if len(top3) >= 3:
        return (top3[0][0], top3[1][0], top3[2][0])
    else:
        return top3

# Returns (4, 3, 9) with no fraud
in1 = [(2186,10),(6724,7),(782,7),(5614,8),(8114,6),(2642,1),(578,4),(9432,9),
(2828,10),(3463,5),(4598,8),(3524,3),(7569,3),(8829,8),(1335,2),(3223,3),(973,4),
(9939,9),(944,10),(8011,7),(7674,9),(9830,1),(5564,7),(2942,2),(7912,10),(1799,5),
(1543,7),(3507,10),(404,8),(7642,5),(5491,7),(9213,8),(2188,7),(1740,4),(1268,5),
(3664,9),(8280,1),(4935,7),(6437,3),(9979,3),(3890,1),(3448,6),(230,3),(9188,4),
(8445,9),(6353,4),(4462,3),(8424,5),(8493,2),(9605,3),(1310,2),(4356,9),(969,10),
(4375,7),(8243,6),(4881,10),(8659,6),(4348,2),(5797,4),(7119,4),(1096,2),(184,6),
(6304,9),(6894,4),(9690,2),(3502,8),(4187,3),(7562,8),(4785,10),(879,2),(6183,4),
(3694,3),(585,9),(3995,4),(8685,4),(5599,2),(1411,5),(7464,8),(9294,3),(1244,1),
(2705,4),(9289,7),(3696,10),(6984,8),(4233,8),(4380,7),(9339,9),(5397,2),(9327,4),
(635,6),(9566,8),(3968,1),(234,9),(5996,2),(4818,4),(3942,3),(5341,9),(1549,9),
(298,3),(1398,1)]
print(Solution(in1))

#
print("---------------Next test--------------")
#

# Should return (5,3,2) with several warnings of fraud.
in1 = [(35,2),(46,1),(4,5),(41,3),(38,5),(25,4),(26,5),(7,2),(10,3),(5,5),(7,2),
(18,5),(15,4),(1,5),(34,3),(46,4),(32,5),(2,5),(21,1),(23,5),(2,3),(2,3),(27,5),
(18,1),(5,2),(21,2),(28,5),(18,5),(33,4),(3,3),(34,5),(23,4),(15,3),(16,4),(18,1),
(33,1),(37,5),(32,3),(15,2),(40,5),(42,2),(26,1),(29,4),(45,1),(4,1),(16,3),(48,5),
(17,5),(28,3),(12,1),(17,2),(38,3),(11,2),(26,3),(14,2),(2,3),(35,5),(7,5),(2,2),
(42,1),(34,5),(14,4),(23,2),(15,3),(27,5),(45,2),(22,4),(17,4),(41,1),(30,5),(35,1),
(9,2),(40,5),(18,5),(19,5),(45,2),(47,3),(41,4),(22,5),(33,4),(16,5),(31,3),(18,3),
(45,2),(41,2),(28,2),(47,4),(26,1),(3,3),(34,4),(48,2),(38,4),(50,3),
(14,3),(21,1),(28,3),(3,5),(9,5),(3,3),(13,3)]
print(Solution(in1))